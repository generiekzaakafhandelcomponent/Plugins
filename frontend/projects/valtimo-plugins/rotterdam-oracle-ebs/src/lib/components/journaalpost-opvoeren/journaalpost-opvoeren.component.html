 <!--
  ~ Copyright 2015-2025 Ritense BV, the Netherlands.
  ~
  ~ Licensed under EUPL, Version 1.2 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ https://joinup.ec.europa.eu/collection/eupl/eupl-text-eupl-12
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" basis,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<ng-container *ngIf="{
    disabled: disabled$ | async,
    prefill: prefillConfiguration$ ? (prefillConfiguration$ | async) : null
} as obs">
    <form [formGroup]="pluginActionForm">

        <app-input-field
            [pluginId]="pluginId"
            [formGroup]=pluginActionForm
            controlName="procesCode"
            title="procesCode"
            tooltip="procesCodeTooltip"
            [required]="true"
        ></app-input-field>

        <app-input-field
            [pluginId]="pluginId"
            [formGroup]=pluginActionForm
            controlName="referentieNummer"
            title="referentieNummer"
            tooltip="referentieNummerTooltip"
            [required]="true"
        ></app-input-field>

        <app-input-field
            [pluginId]="pluginId"
            [formGroup]=pluginActionForm
            controlName="sleutel"
            title="sleutel"
            tooltip="sleutelTooltip"
            [required]="true"
        ></app-input-field>

        <app-input-field
            [pluginId]="pluginId"
            [formGroup]=pluginActionForm
            controlName="boekdatumTijd"
            title="boekdatum"
            tooltip="boekdatumTooltip"
            [required]="true"
        ></app-input-field>

        <app-input-field
            [pluginId]="pluginId"
            [formGroup]=pluginActionForm
            controlName="categorie"
            title="categorie"
            tooltip="categorieTooltip"
            [required]="true"
        ></app-input-field>

        <app-select-field
            [pluginId]="pluginId"
            [formGroup]=pluginActionForm
            controlName="saldoSoort"
            title="saldoSoort"
            tooltip="saldoSoortTooltip"
            placeholder="saldoSoortPlaceholder"
            [required]="true"
            [items]="saldoSoortItems"
        ></app-select-field>

        <app-input-field
            [pluginId]="pluginId"
            [formGroup]=pluginActionForm
            controlName="omschrijving"
            title="omschrijving"
            tooltip="omschrijvingTooltip"
            [required]="true"
        ></app-input-field>

        <app-input-field
            [pluginId]="pluginId"
            [formGroup]=pluginActionForm
            controlName="boekjaar"
            title="boekjaar"
            tooltip="boekjaarTooltip"
            [required]="true"
        ></app-input-field>

        <app-input-field
            [pluginId]="pluginId"
            [formGroup]=pluginActionForm
            controlName="boekperiode"
            title="boekperiode"
            tooltip="boekperiodeTooltip"
            [required]="true"
        ></app-input-field>

        <div>
            <v-input-label
                [required]="true"
                [title]="'journaalpostRegels' | pluginTranslate: pluginId | async"
                [tooltip]="'journaalpostTooltip' | pluginTranslate: pluginId | async"
            >
            </v-input-label>
            <div formArrayName="regels" class="lines-wrapper">
                <div class="line-wrapper"
                     *ngFor="let line of lines.controls; let i = index">
                    <app-input-field
                        [pluginId]="pluginId"
                        [formGroup]=pluginActionForm
                        controlName="grootboekSleutel"
                        wrapperClass="line-field-wrapper"
                        title="grootboekSleutel"
                        [required]="true"
                    ></app-input-field>

                    <app-select-field
                        [pluginId]="pluginId"
                        [formGroup]=pluginActionForm
                        controlName="boekingType"
                        wrapperClass="line-field-wrapper"
                        title="boekingType"
                        placeholder="boekingTypePlaceholder"
                        [required]="true"
                        [items]="boekingTypeItems"
                    ></app-select-field>

                    <app-input-field
                        [pluginId]="pluginId"
                        [formGroup]=pluginActionForm
                        controlName="omschrijving"
                        wrapperClass="line-field-wrapper"
                        title="regelOmschrijving"
                        [required]="false"
                    ></app-input-field>

                    <app-input-field
                        [pluginId]="pluginId"
                        [formGroup]=pluginActionForm
                        controlName="bedrag"
                        wrapperClass="line-field-wrapper"
                        title="bedrag"
                        [required]="true"
                    ></app-input-field>

                    <div class="remove-line-wrapper">
                        <button type="button"
                                cdsButton="secondary"
                                (click)="removeLine(i)"
                                [disabled]="obs.disabled"
                        >
                            {{'regelVerwijderen' | pluginTranslate: pluginId | async}}
                            <svg class="cds--btn__icon" cdsIcon="subtract" size="16"></svg>
                        </button>
                    </div>
                </div>
            </div>
            <div class="add-line-wrapper">
                <button type="button"
                        cdsButton="secondary"
                        (click)="addLine()"
                        [disabled]="obs.disabled">
                    {{'regelToevoegen' | pluginTranslate: pluginId | async}}
                    <svg class="cds--btn__icon" cdsIcon="add" size="16"></svg>
                </button>
            </div>
        </div>
    </form>

</ng-container>
